<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>My movies</title>
        <script type="text/javascript" src="jquery-1.6.1.min.js"></script>
        <link rel="stylesheet" type="text/css" href="common.css"/>
        <link rel="stylesheet" type="text/css" href="themes/dark/style.css"/>
    </head>
    <body>
		<div class="sitecontainer">
			<div class="movies"></div>
			<div id="templates">
				<div class="movieclassic">
					<img class="cover" />
					<div class="content">
						<div class="title"></div>
						<div class="principals"></div>
						<div class="plot"></div>
						<div class="stars"><div></div></div>
						<pre class="files"></pre>
						<a class="play">Play</a>
					</div>
                    <div class="clear"></div>
				</div>
			</div>
		</div>
        <script type="text/javascript">
            $(function () {
				//Usefull to test/edit layout
				var base = window.location.href.indexOf('file://') === 0
					? 'http://localhost:8080' : '';
                $.getJSON(base + '/*movies?jsonp=?', function (o) {
                    var template = $('#templates .movieclassic');
                    $.each(o, function () {
                        var m = this;
                        var e = template.clone();
                        $('.cover', e).attr('src', base + '/*scale/300x/' + (m.Cover ? 'covers/' + m.Cover : 'img/nocover.jpg'));
						var title = m.Title;
						if(m.Year)
							title += ' - ' + m.Year;
                        $('.title', e).text(title);
						$('.principals', e).text(m.Principals.join(' - '));
						$('.plot', e).text(m.Plot);
						if(m.ImdbRating)
							$('.stars', e).show().children().css('width', (10 * m.ImdbRating) + '%');
						$('.files', e).text(m.Files.join('\n'));
                        $('.play', e).click(function () {
                            $.get(base + '/*play', { f: m.Files[0] });
                        });
                        $('.movies').append(e);
                    });
                });
            });
        </script>
    </body>
</html>
